"use strict";(self.webpackChunk_calcom_web=self.webpackChunk_calcom_web||[]).push([[5259],{"../../packages/app-store/EventTypeAppContext.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{j:()=>useAppContextWithSchema});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/next/dist/compiled/react/index.js");const EventTypeAppContext=react__WEBPACK_IMPORTED_MODULE_0__.createContext({getAppData:()=>({}),setAppData:()=>({})}),useAppContextWithSchema=()=>react__WEBPACK_IMPORTED_MODULE_0__.useContext(EventTypeAppContext)},"../../packages/app-store/_components/AppCard.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>AppCard});var jsx_runtime=__webpack_require__("../../node_modules/next/dist/compiled/react/jsx-runtime.js"),react=__webpack_require__("../../node_modules/@formkit/auto-animate/react/index.mjs"),next_link=__webpack_require__("../../node_modules/next/link.js"),link_default=__webpack_require__.n(next_link),es=__webpack_require__("../../node_modules/react-i18next/dist/es/index.js"),EventTypeAppContext=__webpack_require__("../../packages/app-store/EventTypeAppContext.tsx"),useIsPlatform=__webpack_require__("../../packages/platform/atoms/hooks/useIsPlatform.ts"),Switch=__webpack_require__("../../packages/ui/components/form/switch/Switch.tsx"),Badge=__webpack_require__("../../packages/ui/components/badge/Badge.tsx"),Icon=__webpack_require__("../../packages/ui/components/icon/Icon.tsx"),Avatar=__webpack_require__("../../packages/ui/components/avatar/Avatar.tsx"),Button=__webpack_require__("../../packages/ui/components/button/Button.tsx"),classNames=__webpack_require__("../../packages/ui/classNames.ts"),next_auth_react=__webpack_require__("../../node_modules/next-auth/react/index.js"),trpc=__webpack_require__("../../packages/trpc/react/trpc.ts");var useLocale=__webpack_require__("../../packages/lib/hooks/useLocale.ts"),showToast=__webpack_require__("../../packages/ui/components/toast/showToast.tsx"),useAddAppMutation=__webpack_require__("../../packages/app-store/_utils/useAddAppMutation.ts"),components=__webpack_require__("../../packages/app-store/components.tsx");function OmniInstallAppButton({appId,className,returnTo,teamId}){const{t}=(0,useLocale.Y)(),{data:app}=function useApp(appId){const{status}=(0,next_auth_react.useSession)();return trpc.i.viewer.apps.appById.useQuery({appId},{enabled:"authenticated"===status})}(appId),utils=trpc.i.useUtils(),mutation=(0,useAddAppMutation.A)(null,{returnTo,onSuccess:data=>{utils.viewer.apps.appById.invalidate({appId}),utils.viewer.apps.integrations.invalidate({extendsFeature:"EventType",...teamId&&{teamId}}),(null==data?void 0:data.setupPending)||(0,showToast.P0)(t("app_successfully_installed"),"success")},onError:error=>{error instanceof Error&&(0,showToast.P0)(error.message||t("app_could_not_be_installed"),"error")}});return app?(0,jsx_runtime.jsx)(components.p$,{type:app.type,teamsPlanRequired:app.teamsPlanRequired,wrapperClassName:(0,classNames.A)("[@media(max-width:260px)]:w-full",className),render:({useDefaultComponent,...props})=>(useDefaultComponent&&(props={...props,onClick:()=>{mutation.mutate({type:app.type,variant:app.variant,slug:app.slug,...teamId&&{teamId}})}}),(0,jsx_runtime.jsx)(Button.$,{loading:mutation.isPending,color:"secondary",className:"[@media(max-width:260px)]:w-full [@media(max-width:260px)]:justify-center",StartIcon:"plus",...props,children:t("add")}))}):null}function AppCard({app,description,switchOnClick,switchChecked,children,returnTo,teamId,disableSwitch,switchTooltip,hideSettingsIcon=!1,hideAppCardOptions=!1}){const{t}=(0,es.Bd)(),[animationRef]=(0,react.Q)(),{setAppData,LockedIcon,disabled:managedDisabled}=(0,EventTypeAppContext.j)(),isPlatform=(0,useIsPlatform.X)();return(0,jsx_runtime.jsxs)("div",{className:(0,classNames.A)("border-subtle",(null==app?void 0:app.isInstalled)&&"mb-4 rounded-md border",!app.enabled&&"grayscale"),children:[(0,jsx_runtime.jsx)("div",{className:(0,classNames.A)(app.isInstalled?"p-4 text-sm sm:p-4":"px-5 py-4 text-sm sm:px-5"),children:(0,jsx_runtime.jsxs)("div",{className:"flex w-full flex-col gap-2 sm:flex-row sm:gap-0",children:[(0,jsx_runtime.jsx)(link_default(),{href:`/apps/${app.slug}`,className:(0,classNames.A)((null==app?void 0:app.isInstalled)?"mr-[11px]":"mr-3","h-auto w-10 rounded-sm"),children:(0,jsx_runtime.jsx)("img",{className:(0,classNames.A)((null==app?void 0:app.logo.includes("-dark"))&&"dark:invert",(null==app?void 0:app.isInstalled)?"min-w-[42px]":"min-w-[40px]","w-full"),src:null==app?void 0:app.logo,alt:null==app?void 0:app.name})}),(0,jsx_runtime.jsxs)("div",{className:"flex flex-col pe-3",children:[(0,jsx_runtime.jsxs)("div",{className:"text-emphasis",children:[(0,jsx_runtime.jsx)("span",{className:(0,classNames.A)((null==app?void 0:app.isInstalled)&&"text-base","font-semibold leading-4"),children:null==app?void 0:app.name}),!(null==app?void 0:app.isInstalled)&&(0,jsx_runtime.jsx)("span",{className:"bg-emphasis ml-1 rounded px-1 py-0.5 text-xs font-medium leading-3 tracking-[0.01em]",children:(null==app?void 0:app.categories[0].charAt(0).toUpperCase())+(null==app?void 0:app.categories[0].slice(1))})]}),(0,jsx_runtime.jsx)("p",{title:null==app?void 0:app.description,className:"text-default line-clamp-1 pt-1 text-sm font-normal",children:description||(null==app?void 0:app.description)})]}),(0,jsx_runtime.jsxs)("div",{className:"ml-auto flex items-center space-x-2",children:[app.credentialOwner&&!isPlatform&&(0,jsx_runtime.jsx)("div",{className:"ml-auto",children:(0,jsx_runtime.jsx)(Badge.E,{variant:"gray",children:(0,jsx_runtime.jsxs)("div",{className:"flex items-center",children:[(0,jsx_runtime.jsx)(Avatar.e,{className:"mr-2",alt:app.credentialOwner.name||"Credential Owner Name",size:"sm",imageSrc:app.credentialOwner.avatar}),app.credentialOwner.name]})})}),(null==app?void 0:app.isInstalled)||app.credentialOwner?(0,jsx_runtime.jsx)("div",{className:"ml-auto flex items-center",children:(0,jsx_runtime.jsx)(Switch.d,{disabled:!app.enabled||managedDisabled||disableSwitch,onCheckedChange:enabled=>{switchOnClick&&switchOnClick(enabled),setAppData("enabled",enabled)},checked:switchChecked,LockedIcon,"data-testid":`${app.slug}-app-switch`,tooltip:switchTooltip})}):(0,jsx_runtime.jsx)(OmniInstallAppButton,{className:"ml-auto flex items-center",appId:app.slug,returnTo,teamId})]})]})}),hideAppCardOptions?null:(0,jsx_runtime.jsxs)("div",{ref:animationRef,children:[(null==app?void 0:app.isInstalled)&&switchChecked&&(0,jsx_runtime.jsx)("hr",{className:"border-subtle"}),(null==app?void 0:app.isInstalled)&&switchChecked?void 0===app.isSetupAlready||app.isSetupAlready?(0,jsx_runtime.jsxs)("div",{className:"relative p-4 pt-5 text-sm [&_input]:mb-0 [&_input]:leading-4",children:[!hideSettingsIcon&&!isPlatform&&(0,jsx_runtime.jsx)(link_default(),{href:`/apps/${app.slug}/setup`,className:"absolute right-4 top-4",children:(0,jsx_runtime.jsx)(Icon.A,{name:"settings",className:"text-default h-4 w-4","aria-hidden":"true"})}),children]}):(0,jsx_runtime.jsxs)("div",{className:"flex h-64 w-full flex-col items-center justify-center gap-4 ",children:[(0,jsx_runtime.jsx)("p",{children:t("this_app_is_not_setup_already")}),(0,jsx_runtime.jsx)(link_default(),{href:`/apps/${app.slug}/setup`,children:(0,jsx_runtime.jsx)(Button.$,{StartIcon:"settings",children:t("setup")})})]}):null]})]})}OmniInstallAppButton.__docgenInfo={description:"Use this component to allow installing an app from anywhere on the app.\nUse of this component requires you to remove custom InstallAppButtonComponent so that it can manage the redirection itself",methods:[],displayName:"OmniInstallAppButton",props:{appId:{required:!0,tsType:{name:"string"},description:""},className:{required:!0,tsType:{name:"string"},description:""},returnTo:{required:!1,tsType:{name:"string"},description:""},teamId:{required:!1,tsType:{name:"number"},description:""}}},AppCard.__docgenInfo={description:"",methods:[],displayName:"AppCard",props:{app:{required:!0,tsType:{name:"intersection",raw:'RouterOutputs["viewer"]["apps"]["integrations"]["items"][number] & {\n  credentialOwner?: CredentialOwner;\n}',elements:[{name:'inferRouterOutputs["viewer"]["apps"]["integrations"]["items"][number]',raw:'RouterOutputs["viewer"]["apps"]["integrations"]["items"][number]'},{name:"signature",type:"object",raw:"{\n  credentialOwner?: CredentialOwner;\n}",signature:{properties:[{key:"credentialOwner",value:{name:"CredentialOwner",required:!1}}]}}]},description:""},description:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},switchChecked:{required:!1,tsType:{name:"boolean"},description:""},switchOnClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(e: boolean) => void",signature:{arguments:[{type:{name:"boolean"},name:"e"}],return:{name:"void"}}},description:""},children:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},returnTo:{required:!1,tsType:{name:"string"},description:""},teamId:{required:!1,tsType:{name:"number"},description:""},LockedIcon:{required:!1,tsType:{name:"ReactReactNode",raw:"React.ReactNode"},description:""},disableSwitch:{required:!1,tsType:{name:"boolean"},description:""},switchTooltip:{required:!1,tsType:{name:"string"},description:""},hideSettingsIcon:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},hideAppCardOptions:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}}}}},"../../packages/app-store/_utils/useIsAppEnabled.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/next/dist/compiled/react/index.js"),_calcom_app_store_EventTypeAppContext__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/app-store/EventTypeAppContext.tsx");const __WEBPACK_DEFAULT_EXPORT__=function useIsAppEnabled(app){const{getAppData,setAppData}=(0,_calcom_app_store_EventTypeAppContext__WEBPACK_IMPORTED_MODULE_1__.j)(),[enabled,setEnabled]=(0,react__WEBPACK_IMPORTED_MODULE_0__.useState)((()=>{const isAppEnabled=getAppData("enabled");if(!app.credentialOwner)return null!=isAppEnabled&&isAppEnabled;const credentialId=getAppData("credentialId"),isAppEnabledForCredential=isAppEnabled&&(app.userCredentialIds.some((id=>id===credentialId))||app.credentialOwner.credentialId===credentialId);return null!=isAppEnabledForCredential&&isAppEnabledForCredential}));return{enabled,updateEnabled:newValue=>{var _app_userCredentialIds,_app_credentialOwner,_app_credentialOwner1;(newValue||setAppData("credentialId",void 0),newValue&&((null===(_app_userCredentialIds=app.userCredentialIds)||void 0===_app_userCredentialIds?void 0:_app_userCredentialIds.length)||(null===(_app_credentialOwner=app.credentialOwner)||void 0===_app_credentialOwner?void 0:_app_credentialOwner.credentialId)))&&setAppData("credentialId",(null===(_app_credentialOwner1=app.credentialOwner)||void 0===_app_credentialOwner1?void 0:_app_credentialOwner1.credentialId)||app.userCredentialIds[0]);setEnabled(newValue)}}}},"../../packages/app-store/matomo/components/EventTypeAppCardInterface.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/next/dist/compiled/react/jsx-runtime.js"),_calcom_app_store_EventTypeAppContext__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../packages/app-store/EventTypeAppContext.tsx"),_calcom_app_store_components_AppCard__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../../packages/app-store/_components/AppCard.tsx"),_calcom_app_store_utils_useIsAppEnabled__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../../packages/app-store/_utils/useIsAppEnabled.ts"),_calcom_ui_components_form__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../packages/ui/components/form/inputs/TextField.tsx");const EventTypeAppCard=function EventTypeAppCard({app,eventType}){var _eventType_team;const{getAppData,setAppData,disabled}=(0,_calcom_app_store_EventTypeAppContext__WEBPACK_IMPORTED_MODULE_1__.j)(),matomoUrl=getAppData("MATOMO_URL"),siteId=getAppData("SITE_ID"),{enabled,updateEnabled}=(0,_calcom_app_store_utils_useIsAppEnabled__WEBPACK_IMPORTED_MODULE_2__.A)(app);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_calcom_app_store_components_AppCard__WEBPACK_IMPORTED_MODULE_3__.A,{hideSettingsIcon:!0,app,switchOnClick:e=>{updateEnabled(e)},switchChecked:enabled,teamId:(null===(_eventType_team=eventType.team)||void 0===_eventType_team?void 0:_eventType_team.id)||void 0,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_calcom_ui_components_form__WEBPACK_IMPORTED_MODULE_4__.A_,{dataTestid:`${app.slug}-url`,name:"Matomo URL",placeholder:"Enter your Matomo URL here",value:matomoUrl,disabled,onChange:e=>{setAppData("MATOMO_URL",e.target.value)}}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_calcom_ui_components_form__WEBPACK_IMPORTED_MODULE_4__.A_,{dataTestid:`${app.slug}-site-id`,disabled,name:"Site ID",placeholder:"Enter your Site ID",value:siteId,onChange:e=>{setAppData("SITE_ID",e.target.value)}})]})})},__WEBPACK_DEFAULT_EXPORT__=EventTypeAppCard;EventTypeAppCard.__docgenInfo={description:"",methods:[],displayName:"EventTypeAppCard"}}}]);